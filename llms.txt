# healthbR ![](reference/figures/logo.png)

## Overview

healthbR provides easy access to Brazilian public health survey data
directly from R. The package downloads, caches, and processes data from
official sources, returning clean, analysis-ready tibbles following
tidyverse conventions.

Currently supported data sources:

- **VIGITEL** - Surveillance of Risk Factors for Chronic Diseases by
  Telephone Survey - Years 2006-2024
- **PNS** - National Health Survey (microdata + SIDRA API) - Years 2013,
  2019
- **PNAD Continua** - Continuous National Household Sample Survey -
  Years 2012-2024
- **POF** - Household Budget Survey (food security, consumption,
  anthropometry) - Years 2002-2018
- **Censo Demografico** - Population denominators via SIDRA API - Census
  1970-2022, estimates 2001-2021

Planned for future releases:

- SIM (Mortality Information System)
- SINASC (Live Birth Information System)
- SIH (Hospital Information System)

## Installation

You can install the development version of healthbR from GitHub:

``` r
# install.packages("pak")
pak::pak("SidneyBissoli/healthbR")
```

## Usage

### Check available years

``` r
library(healthbR)

# list available VIGITEL survey years
vigitel_years()
#> [1] 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020
#> [16] 2021 2022 2023 2024
```

### Download and load data

``` r
# load data for a single year
df <- vigitel_data(year = 2024)

# load data for multiple years
df <- vigitel_data(year = 2020:2024)

# load all available years
df <- vigitel_data()

# choose data format (default is Stata .dta which preserves labels)
df <- vigitel_data(year = 2024, format = "dta")
df <- vigitel_data(year = 2024, format = "csv")

# select specific variables
df <- vigitel_data(
  year = 2024,
  vars = c("cidade", "sexo", "idade", "pesorake")
)
```

### Explore variables

``` r
# get the data dictionary with variable descriptions
dict <- vigitel_dictionary()

# list variables (same as dictionary)
vars <- vigitel_variables()

# view the dictionary structure
head(dict)
```

### Survey analysis with srvyr

VIGITEL uses complex survey sampling. Use the `pesorake` weight variable
for proper inference:

``` r
library(dplyr)
library(srvyr)

# create survey design
vigitel_svy <- df |>
  as_survey_design(weights = pesorake)

# calculate weighted prevalence
vigitel_svy |>
  group_by(cidade) |>
  summarize(
    prevalence = survey_mean(diab == 1, na.rm = TRUE),
    n = unweighted(n())
  )
```

## Performance optimization

healthbR automatically optimizes data loading using partitioned parquet
caching when the `arrow` package is installed.

### Automatic parquet caching (recommended)

Install the `arrow` package for significantly faster subsequent reads:

``` r
# install arrow for better performance
install.packages("arrow")

# first load downloads and creates partitioned cache
df <- vigitel_data(year = 2024)

# subsequent loads are extremely fast (reads only requested year)
df <- vigitel_data(year = 2024)  # instant!
```

When `arrow` is installed: - Data is automatically cached in partitioned
parquet format - Reading a single year loads only that year’s partition
(~25MB instead of ~500MB) - Multiple years are combined efficiently

### Cache management

``` r
# check cache status
vigitel_cache_status()

# clear cache (all files)
vigitel_clear_cache()

# clear only source files, keep parquet cache
vigitel_clear_cache(keep_parquet = TRUE)
```

## Data sources

All data is downloaded from official Brazilian Ministry of Health
repositories:

- VIGITEL: <https://svs.aids.gov.br/daent/cgdnt/vigitel/>

## Citation

If you use healthbR in your research, please cite it:

``` r
citation("healthbR")
```

## Contributing

Contributions are welcome! Please open an issue to discuss proposed
changes or submit a pull request.

## Code of Conduct

Please note that the healthbR project is released with a [Contributor
Code of
Conduct](https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.

## License

MIT © Sidney da Silva Pereira Bissoli

# Package index

## All functions

- [`censo_estimativa()`](https://sidneybissoli.github.io/healthbR/reference/censo_estimativa.md)
  : Get intercensitary population estimates
- [`censo_info()`](https://sidneybissoli.github.io/healthbR/reference/censo_info.md)
  : Census information
- [`censo_populacao()`](https://sidneybissoli.github.io/healthbR/reference/censo_populacao.md)
  : Get Census population data
- [`censo_sidra_data()`](https://sidneybissoli.github.io/healthbR/reference/censo_sidra_data.md)
  : Get Census data from SIDRA API
- [`censo_sidra_search()`](https://sidneybissoli.github.io/healthbR/reference/censo_sidra_search.md)
  : Search Census SIDRA tables
- [`censo_sidra_tables()`](https://sidneybissoli.github.io/healthbR/reference/censo_sidra_tables.md)
  : List Census SIDRA tables
- [`censo_years()`](https://sidneybissoli.github.io/healthbR/reference/censo_years.md)
  : List available Census years
- [`list_sources()`](https://sidneybissoli.github.io/healthbR/reference/list_sources.md)
  : List Available Data Sources
- [`pnadc_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_cache_status.md)
  : Get PNADC cache status
- [`pnadc_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_clear_cache.md)
  : Clear PNADC cache
- [`pnadc_data()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_data.md)
  : Download PNADC microdata
- [`pnadc_dictionaries()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_dictionaries.md)
  : Download PNADC variable dictionary
- [`pnadc_info()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_info.md)
  : PNADC survey information
- [`pnadc_modules()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_modules.md)
  : List available PNADC modules
- [`pnadc_variables()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_variables.md)
  : List PNADC variables
- [`pnadc_years()`](https://sidneybissoli.github.io/healthbR/reference/pnadc_years.md)
  : List available years for a PNADC module
- [`pns_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/pns_cache_status.md)
  : Get PNS cache status
- [`pns_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/pns_clear_cache.md)
  : Clear PNS cache
- [`pns_data()`](https://sidneybissoli.github.io/healthbR/reference/pns_data.md)
  : Download PNS microdata
- [`pns_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/pns_dictionary.md)
  : Download PNS variable dictionary
- [`pns_info()`](https://sidneybissoli.github.io/healthbR/reference/pns_info.md)
  : PNS survey information
- [`pns_modules()`](https://sidneybissoli.github.io/healthbR/reference/pns_modules.md)
  : List PNS survey modules
- [`pns_sidra_data()`](https://sidneybissoli.github.io/healthbR/reference/pns_sidra_data.md)
  : Get PNS tabulated data from SIDRA API
- [`pns_sidra_search()`](https://sidneybissoli.github.io/healthbR/reference/pns_sidra_search.md)
  : Search PNS SIDRA tables
- [`pns_sidra_tables()`](https://sidneybissoli.github.io/healthbR/reference/pns_sidra_tables.md)
  : List PNS SIDRA tables
- [`pns_variables()`](https://sidneybissoli.github.io/healthbR/reference/pns_variables.md)
  : List PNS variables
- [`pns_years()`](https://sidneybissoli.github.io/healthbR/reference/pns_years.md)
  : List available PNS survey years
- [`pof_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/pof_cache_status.md)
  : Get POF cache status
- [`pof_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/pof_clear_cache.md)
  : Clear POF cache
- [`pof_data()`](https://sidneybissoli.github.io/healthbR/reference/pof_data.md)
  : Download and import POF microdata
- [`pof_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/pof_dictionary.md)
  : Get POF variable dictionary
- [`pof_info()`](https://sidneybissoli.github.io/healthbR/reference/pof_info.md)
  : Get POF survey information
- [`pof_registers()`](https://sidneybissoli.github.io/healthbR/reference/pof_registers.md)
  : List POF registers
- [`pof_variables()`](https://sidneybissoli.github.io/healthbR/reference/pof_variables.md)
  : List POF variables
- [`pof_years()`](https://sidneybissoli.github.io/healthbR/reference/pof_years.md)
  : List available POF survey years
- [`sia_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/sia_cache_status.md)
  : Show SIA Cache Status
- [`sia_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/sia_clear_cache.md)
  : Clear SIA Cache
- [`sia_data()`](https://sidneybissoli.github.io/healthbR/reference/sia_data.md)
  : Download SIA Outpatient Production Microdata
- [`sia_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/sia_dictionary.md)
  : SIA Data Dictionary
- [`sia_info()`](https://sidneybissoli.github.io/healthbR/reference/sia_info.md)
  : SIA Module Information
- [`sia_variables()`](https://sidneybissoli.github.io/healthbR/reference/sia_variables.md)
  : List SIA Variables
- [`sia_years()`](https://sidneybissoli.github.io/healthbR/reference/sia_years.md)
  : List Available SIA Years
- [`sih_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/sih_cache_status.md)
  : Show SIH Cache Status
- [`sih_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/sih_clear_cache.md)
  : Clear SIH Cache
- [`sih_data()`](https://sidneybissoli.github.io/healthbR/reference/sih_data.md)
  : Download SIH Hospital Admission Microdata
- [`sih_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/sih_dictionary.md)
  : SIH Data Dictionary
- [`sih_info()`](https://sidneybissoli.github.io/healthbR/reference/sih_info.md)
  : SIH Module Information
- [`sih_variables()`](https://sidneybissoli.github.io/healthbR/reference/sih_variables.md)
  : List SIH Variables
- [`sih_years()`](https://sidneybissoli.github.io/healthbR/reference/sih_years.md)
  : List Available SIH Years
- [`sim_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/sim_cache_status.md)
  : Show SIM Cache Status
- [`sim_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/sim_clear_cache.md)
  : Clear SIM Cache
- [`sim_data()`](https://sidneybissoli.github.io/healthbR/reference/sim_data.md)
  : Download SIM Mortality Microdata
- [`sim_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/sim_dictionary.md)
  : SIM Data Dictionary
- [`sim_info()`](https://sidneybissoli.github.io/healthbR/reference/sim_info.md)
  : SIM Module Information
- [`sim_variables()`](https://sidneybissoli.github.io/healthbR/reference/sim_variables.md)
  : List SIM Variables
- [`sim_years()`](https://sidneybissoli.github.io/healthbR/reference/sim_years.md)
  : List Available SIM Years
- [`sinasc_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_cache_status.md)
  : Show SINASC Cache Status
- [`sinasc_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_clear_cache.md)
  : Clear SINASC Cache
- [`sinasc_data()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_data.md)
  : Download SINASC Live Birth Microdata
- [`sinasc_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_dictionary.md)
  : SINASC Data Dictionary
- [`sinasc_info()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_info.md)
  : SINASC Module Information
- [`sinasc_variables()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_variables.md)
  : List SINASC Variables
- [`sinasc_years()`](https://sidneybissoli.github.io/healthbR/reference/sinasc_years.md)
  : List Available SINASC Years
- [`utils`](https://sidneybissoli.github.io/healthbR/reference/utils.md)
  : Utility Functions for healthbR
- [`vigitel_cache_status()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_cache_status.md)
  : Get VIGITEL cache status
- [`vigitel_clear_cache()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_clear_cache.md)
  : Clear VIGITEL cache
- [`vigitel_data()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_data.md)
  : Download VIGITEL microdata
- [`vigitel_dictionary()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_dictionary.md)
  : Get VIGITEL variable dictionary
- [`vigitel_info()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_info.md)
  : Get VIGITEL survey information
- [`vigitel_variables()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_variables.md)
  : List VIGITEL variables
- [`vigitel_years()`](https://sidneybissoli.github.io/healthbR/reference/vigitel_years.md)
  : List available VIGITEL survey years

# Articles

### All vignettes

- [Population Denominators from the Census with
  healthbR](https://sidneybissoli.github.io/healthbR/articles/censo-denominadores.md):
- [DATASUS Modules: SIM, SINASC, SIH, and
  SIA](https://sidneybissoli.github.io/healthbR/articles/datasus-modules.md):
- [Introduction to
  healthbR](https://sidneybissoli.github.io/healthbR/articles/healthbR.md):
- [Analyzing Health Data from POF with
  healthbR](https://sidneybissoli.github.io/healthbR/articles/pof-health-data.md):
